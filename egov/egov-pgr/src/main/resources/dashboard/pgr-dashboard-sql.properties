pgr.comp.reg.weekly.trend = SELECT TO_CHAR(createddate, 'MM') ||'-'|| TO_CHAR(createddate, 'DD')  AS MONTHDAY,COUNT(*)  AS compno \
FROM egpgr_complaint cd WHERE createddate BETWEEN :fromDate AND :toDate \
GROUP BY TO_CHAR(createddate, 'MM'),TO_CHAR(createddate, 'DD') ORDER BY TO_CHAR(createddate, 'MM'),TO_CHAR(createddate, 'DD')

pgr.comp.resolution.weekly.trend = SELECT SUM(crd.compCnt),crd.days FROM (SELECT COUNT(*) compCnt, TO_CHAR(c.createddate, 'MM-DD') days, c.crn \
FROM egpgr_complaintstatus cs, egpgr_complaint c WHERE c.createddate BETWEEN :fromDate AND :toDate \
AND c.status = cs.id AND cs.name IN ('COMPLETED','REJECTED','WITHDRAWN','CLOSED') GROUP BY TO_CHAR(c.createddate, 'MM-DD'),c.crn ) as crd GROUP BY crd.days

pgr.comp.six.month.aggr = SELECT TO_CHAR(cd.createddate,'MON-yyyy') as mnth ,COUNT(*) compCnt FROM egpgr_complaint cd \
WHERE cd.createddate BETWEEN :fromDate AND :toDate GROUP BY 1 order by 1;

pgr.comp.type.wise.perc = SELECT ct.name ctname, ct.id ctid, count(ct.name) counts FROM egpgr_complaint cd,egpgr_complainttype ct \
WHERE cd.complaintType =ct.id AND cd.createddate BETWEEN :fromDate AND :toDate GROUP BY ct.name, \
ct.id ORDER BY counts DESC